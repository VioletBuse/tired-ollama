# fly.toml app configuration file generated for tired-ollama on 2025-03-08T18:29:42+01:00
#
# See https://fly.io/docs/reference/configuration/ for information about how to use this file.
#

app = 'tired-ollama'
primary_region = 'ams'
swap_size_mb = 8192

[build]

[mounts]
  source = "models"
  destination = "/root/.ollama"
  initial_size = "100gb"
  auto_extend_size_threshold = 80
  auto_extend_size_increment = "50GB"
  auto_extend_size_limit = "500GB"

[[services]]
  internal_port = 8080
  protocol = "tcp"
  auto_stop_machines = "stop"
  auto_start_machines = true
  min_machines_running = 0

[[services.ports]]
  handlers = ['http']
  port = 11434
  
[[services.ports]]
  handlers = ['http']
  port = 80

[[vm]]
  memory = '32gb'
  cpu_kind = 'performance'
  cpus = 8
  gpu_kind = "a100-sxm4-80gb"
  gpus = 1
